
@if( planEstudio && planEstudio.id != 0 || (tipo == 'asignar' && planEstudio.resolucion == null) ) {
    <!-- <pre>{{ planEstudio | json }}</pre> -->
    <app-card headerClass="py-2 px-2 block" cardClass="m-0 fadein animation-duration-500">
        <ng-template #headerTitleTemplate class="">
            <div class="f-w-600 f-14 text-center">{{ planEstudio.nombre }}</div>
        </ng-template>
        <div class="flex flex-column text-center mb-4">
            <div>{{ planEstudio.resolucion || 'EN PROCESO' }}</div>
        </div>
        <div class="flex align-items-center my-2">
            <div class="avatar avatar-xs flex-shrink-0 m-r-10">
                <i class="f-18 ti ti-calendar"></i> 
            </div>
            <span class="text-left text-truncate w-100"> Inicio</span>
            <div class="w-100 bg-success-500 mat-small text-center text-white user-status f-w-600"> {{ (planEstudio.inicioVigencia | date: 'dd/MM/yyyy') ?? 'No definido' }}</div>
        </div>
        <div class="flex align-items-center my-2">
            <div class="avatar avatar-xs flex-shrink-0 m-r-10">
                <i class="f-18 ti ti-calendar-time"></i> 
            </div>
            <span class="text-left text-truncate w-100"> Fin</span>
            <div class="w-100 bg-success-500 mat-small text-center text-white user-status f-w-600"> {{ (planEstudio.finVigencia | date: 'dd/MM/yyyy') ?? 'No definido' }} </div>
        </div>
    
            <div class="flex align-items-center my-2">
                <div class="avatar avatar-xs flex-shrink-0 m-r-10">
                    <i class="f-18 ti ti-arrow-down"></i> 
                </div>
                <span class="text-left text-truncate w-100"> Estado</span>
                <div class="w-100 bg-success-500 mat-small text-center text-white user-status f-w-600"> {{ planEstudio.estadoCaducidad == 'NO DEFINIDO' ? 'No definido' : planEstudio.estadoCaducidad }} </div>
            </div>
        
   
            <div class="flex align-items-center my-2">
                <div class="avatar avatar-xs flex-shrink-0 m-r-10">
                    <i class="f-18 ti ti-arrow-down"></i> 
                </div>
                <span class="text-left text-truncate w-100"> Matrícula</span>
                <div class="w-100 bg-success-500 mat-small text-center text-white user-status f-w-600">{{ planEstudio.estadoMatricula ?? 'No definido' }} </div>
            </div>
        
        <!-- @if (planEstudio.archivo !== null) { -->
            <div class="w-full mt-4">
                <!-- <div class="w-100 bg-accent-200 text-center user-status f-w-600 border-1 border-gray-500 hover:bg-primary-900 hover:text-white cursor-pointer" (click)="mostrarArchivoPlanEstudio(planEstudio)">
                    <i class="f-34 ti ti-file-download text-gray-500 hover:text-white"></i>
                </div> -->
                <ui-button [disabled]="planEstudio.archivo == null" [matTooltip]="planEstudio.archivo != null ? 'Descargar Plan de Estudios' : 'El Plan de Estudios aún no ha sido cargado'" type="sweet" color="primary" classButton="w-full" (onClick)="mostrarArchivoPlanEstudio(planEstudio)"><i class="f-34 ti ti-file-download"></i></ui-button>
            </div>
        <!-- } -->
        @if ( !isModal() || isModalOfItself()) {
            <ng-template #actionTemplate>
                <div class="flex gap-2 justify-content-around w-full">
                    <ui-button tooltip="Eliminar" color="red" icon="ti ti-trash f-18" (onClick)="eliminarConfirm( planEstudio )" [disabled]="planEstudio.archivo != null"></ui-button>
                    <ui-button tooltip="Editar" color="blue" icon="ti ti-pencil f-18" (onClick)="showFormEdit( planEstudio, planEstudioAdd, 'Edit' )" [disabled]="planEstudio.archivo != null"></ui-button>
                    @if ( planEstudio.archivo != null ) {
                        <ui-button tooltip="Ver Malla" color="cyan" icon="ti ti-eye f-18" (onClick)="verMalla( planEstudio )"></ui-button>
                    }  @else {
                        <ui-button tooltip="Agregar Cursos" color="indigo" icon="ti ti-eye f-18" (onClick)="duplicarConfirm( ultimoPlanConRCU, planEstudio )"></ui-button>
                    }
                    <ui-button tooltip="Ver Perfil de Egresado" color="yellow" icon="ti ti-user f-18" (onClick)="showFormEdit( planEstudio, planEstudioPerfilEgresado, 'Perfil' )"></ui-button>
                </div>
            </ng-template>
        } @else {
            <ng-template #actionTemplate>
                <div class="flex gap-2 justify-content-around w-full">
                    <ui-button tooltip="Ver Malla" color="cyan" icon="ti ti-eye f-18" (onClick)="verMalla( planEstudio )"></ui-button>
                </div>
            </ng-template>
        }
    </app-card>
}
<!-- <pre>{{ ultimoPlanConResolucion() | json }}</pre> -->
<ng-template #planEstudioAdd let-data>
    <plan-estudio-add></plan-estudio-add>
</ng-template>
<ng-template #planEstudioPerfilEgresado let-data>
    <app-plan-estudio-perfil-egresado></app-plan-estudio-perfil-egresado>
</ng-template>
@if ( !isModal() || isModalOfItself()) {
    <malla-curricular-side></malla-curricular-side>
}

<!-- <ng-template #ultimoPlanConRCU let-data>
    <mat-dialog-content>

        <div class="w-20rem m-auto mb-3">
            <plan-estudio-card [planEstudio]="planEstudioUltimoConResolucion()"></plan-estudio-card>
        </div>
        <ui-alert type="info">Se realizará una copia del último Plan de Estudios</ui-alert>
    </mat-dialog-content>
    <mat-dialog-actions align="end" class="gap-2">
        <ui-button icon="ti ti-close f-16" mat-dialog-close="cancelar"> Cancelar</ui-button>
        <ui-button color="indigo" icon="ti ti-wand f-16" (onClick)="duplicar( planEstudioUltimoConResolucion() )"> Duplicar</ui-button>
    </mat-dialog-actions>
</ng-template> -->

<!-- {{ isModalOfItself() }} -->